# remove_from_cart 이벤트 스펙
# GA4 E-Commerce 이벤트: 장바구니에서 상품 삭제

event: remove_from_cart
ga4_event_name: remove_from_cart
dataLayer_event: removeCart
trigger_timing: "상품을 장바구니에서 삭제했을 시"
required: false  # Optional

description: |
  사용자가 장바구니에서 상품을 삭제할 때 발생하는 이벤트입니다.
  삭제 유형(부분/전체)과 삭제된 상품 정보가 포함됩니다.

parameters:
  # 통화 정보
  - ga4_param: currency
    dev_guide_var: AP_ECOMM_CURRENCY
    gtm_variable: "{{JS - Currency}}"
    data_type: string
    description: "통화 코드 (ISO 3자리)"
    example: "KRW"
    required: true

  # 삭제 유형
  - ga4_param: removal_type
    dev_guide_var: AP_CART_REMOVALTYPE
    gtm_variable: "{{JS - Cart Removal Type}}"
    data_type: string
    description: "삭제 선택 범위"
    example: "partial"
    required: true
    validation: |
      partial: 부분 삭제 (선택 삭제)
      all: 전체 삭제

  # 상품 배열 (items)
  - ga4_param: items
    dev_guide_var: AP_CART_REMOVEPRDS
    gtm_variable: "{{JS - Remove Cart DataLayer}}"
    data_type: array
    description: "삭제된 상품 배열 (dataLayer variable에서 확인)"
    required: true

  # 개별 상품 파라미터 (items 배열 내)
  - ga4_param: item_id
    dev_guide_var: code
    gtm_variable: "(items 배열 내)"
    data_type: string
    description: "상품 ID (SKU)"
    example: "111070000513"
    required: true

  - ga4_param: item_name
    dev_guide_var: name
    gtm_variable: "(items 배열 내)"
    data_type: string
    description: "상품 이름"
    example: "블랙 쿠션 SPF34/PA++ (본품 15g+리필 15g)"
    required: true

  - ga4_param: item_brand
    dev_guide_var: brand
    gtm_variable: "(items 배열 내)"
    data_type: string
    description: "상품 브랜드"
    example: "헤라"
    required: true

  - ga4_param: item_category
    dev_guide_var: cate
    gtm_variable: "(items 배열 내)"
    data_type: string
    description: "상품 카테고리 (depth는 '/'로 구분)"
    example: "메이크업/페이스/쿠션"
    required: true

  - ga4_param: item_variant
    dev_guide_var: variant
    gtm_variable: "(items 배열 내)"
    data_type: string
    description: "상품 옵션"
    example: "120ml"
    required: true

  - ga4_param: apg_brand_code
    dev_guide_var: apg_brand_code
    gtm_variable: "(items 배열 내)"
    data_type: string
    description: "아모레퍼시픽 그룹 브랜드 코드"
    example: "11107"
    required: true

  - ga4_param: index
    dev_guide_var: index
    gtm_variable: "(items 배열 내)"
    data_type: number
    description: "장바구니 내 위치"
    example: 1
    required: true

  - ga4_param: quantity
    dev_guide_var: quantity
    gtm_variable: "(items 배열 내)"
    data_type: number
    description: "삭제된 상품 수량"
    example: 2
    required: true

  - ga4_param: price
    dev_guide_var: price
    gtm_variable: "(items 배열 내)"
    data_type: number
    description: "할인이 적용된 최종 가격 (Unit Price)"
    example: 49400
    required: true

  - ga4_param: discount
    dev_guide_var: discount
    gtm_variable: "(items 배열 내)"
    data_type: number
    description: "상품 할인 금액"
    example: 10000
    required: true

  - ga4_param: prdprice
    dev_guide_var: prdprice
    gtm_variable: "(items 배열 내)"
    data_type: number
    description: "할인이 반영되지 않은 상품 금액"
    example: 59400
    required: true

dataLayer_example: |
  var AP_ECOMM_CURRENCY = 'KRW';
  var AP_CART_REMOVALTYPE = 'partial';

  var AP_CART_REMOVEPRDS = [{
    'code': '111070000513',
    'name': '블랙 쿠션 SPF34/PA++ (본품 15g+리필 15g)',
    'brand': '헤라',
    'cate': '메이크업/페이스/쿠션',
    'variant': '120ml',
    'apg_brand_code': '11107',
    'index': '1',
    'quantity': 2,
    'price': 49400,
    'discount': 10000,
    'prdprice': 59400
  }];

  window.dataLayer.push({'event':'removeCart'});

verification_notes:
  - "제품정보(code, name, brand, cate, apg_brand_code)는 모든 전자상거래 단계에서 항상 동일해야 함"
  - "AP_CART_REMOVALTYPE과 AP_CART_REMOVEPRDS는 항상 dataLayer.push 전에 업데이트되어야 함"
  - "price, discount, prdprice는 모두 Unit Price(1개당 가격)로 전송"
  - "GTM parser를 통해 실제 파라미터 매핑 확인 필요"
